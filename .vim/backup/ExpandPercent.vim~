" vim:foldmethod=marker:fen:
scriptencoding utf-8

" DOCUMENT {{{1
"==================================================
" Name: ExpandWords
" Version: 0.0.0
" Author:  tyru <tyru.takuya+vim@gmail.com>
" Last Change: 2009-03-10.
"
" Usage:
"   GLOBAL VARIABLES:
"
"
"
"==================================================
" }}}1

if exists('g:loaded_expand_words') && g:loaded_expand_words != 0 | finish | endif
let g:loaded_expand_words = 1

let s:save_cpo = &cpo
set cpo&vim

let s:chars_hash = {}
if exists('g:ew_chars')
    for ch in split(g:ew_chars, '\zs')
        let s:chars_hash[ch] = 1
    endfor
else
    finish
endif

let s:msg = ''
let s:foo = ''
func s:ExpandWords(col)
    let ch = strpart(getline('.'), a:col - 1, a:col)
    let s:foo .= a:col
    let s:msg .= ch
    if has_key(s:chars_hash, ch) && 0 < a:col && a:col < col('$')
        return s:ExpandWords(a:col - 1) . ch . s:ExpandWords(a:col + 1)
    else
        return ''
    endif
endfunc

command! ExpandWords    echo '[' . s:ExpandWords(col('.')) . ']'
command! Foo    echo printf('s:msg [%s], s:foo [%s]', s:msg, s:foo)

" RESTORE CPO {{{1
let &cpo = s:save_cpo
" }}}1

