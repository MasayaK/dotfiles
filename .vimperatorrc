let mapleader = ','
so $HOME/.vimperatorrc.local

colorscheme vimplight

"-----------------------------------------------------------------
" set! {{{

" via http://retlet.net/log/2008/06/awesomebar-bookmarklet.html
set! browser.urlbar.filter.javascript=false
set! browser.urlbar.maxRichResults=50

" disable accesskey
" set! ui.key.generalAccessKey=0

" open bookmarks in background
set! browser.tabs.loadBookmarksInBackground=true

set! ui.caretWidth=1
set! ui.caretBlinkTime=1000

set! browser.tabs.closeWindowWithLastTab=false

set! dom.popup_maximum=65536

set! config.trim_on_minimize=true

" }}}
"-----------------------------------------------------------------
" misc. {{{

" フィードアイコンをステータスバーに表示
" (via http://memo.officebrook.net/20090906.html)
javascript <<EOF
(function(){
    var feedPanel = document.createElement("statusbarpanel");
    feedPanel.setAttribute("id", "feed-panel-clone");
    feedPanel.appendChild(document.getElementById("feed-button"));
    feedPanel.firstChild.setAttribute("style", "padding: 0; max-height: 16px;");
    document.getElementById("status-bar")
        .insertBefore(feedPanel, document.getElementById("security-button"));
})();
EOF
" }}}
"-----------------------------------------------------------------
" set {{{

set activate=homepage,quickmark,tabopen
set complete=sfl
" set focuscontent
set guioptions=nbr
set hlsearch
set ignorecase
set incsearch
set nextpattern+=\b次
set noinsertmode
set previouspattern+=\b前
set scroll=8
set smartcase
set titlestring=Firefox
set visualbell
set wildoptions=auto

" }}}
"-----------------------------------------------------------------
" map {{{
"
" NOTE: <silent>つけるとむしろ遅いorz

" ~ noremap ~ {{{
noremap <F5>    <Nop>
noremap <BS>    <Nop>

" 上下移動
noremap j   4<C-e>
noremap k   4<C-y>
noremap J   <C-d>
noremap K   <C-u>

" タブ移動
noremap <Right> :tabmove! +1<CR>
noremap <Left>  :tabmove! -1<CR>

" Escで中止
noremap <Esc>   <C-c>

" 戻れるように
noremap gg      mzgg
noremap G       mzG

" フレーム内移動
noremap <C-,>   [f
noremap <C-.>   ]f

" 選択文字列のコピー
noremap <C-c>   Y
" 選択文字列のgoogle検索
noremap <C-g>   YP


" vimperatorだとincsearchのとき
" マッチしなかった場合元の位置に戻らない
noremap /   mz/

noremap <Leader>gf     :tab normal gf<CR>

noremap !       :set invum<CR>

noremap ZZ <Nop>

noremap gt :tab<Space>

" }}}

" ~ c ~ {{{
cnoremap <C-c>          <C-v><C-c>
cnoremap <C-x>          <C-v><C-x>
cnoremap <C-v>          <S-Insert>
cnoremap <C-r><C-r>     <S-Insert>
" 履歴
cnoremap <C-n>      <Down>
cnoremap <C-p>      <Up>
" 移動
cnoremap <C-a>      <Home>
cnoremap <C-e>      <End>
cnoremap <C-d>      <Del>
cnoremap <C-f>      <Right>
cnoremap <C-b>      <Left>
" }}}

" ~ i ~ {{{
" フォーカス中に<C-n>で新しくウィンドウを作らない
inoremap <C-n> <Nop>
" }}}

" }}}
"-----------------------------------------------------------------
" qmark {{{

qmark H http://hatenadiary.g.hatena.ne.jp/keyword/%e3%81%af%e3%81%a6%e3%81%aa%e8%a8%98%e6%b3%95%e4%b8%80%e8%a6%a7
qmark P http://pipes.yahoo.com/pipes/
qmark R http://www.rememberthemilk.com/
qmark T http://tyru.tumblr.com/
qmark d http://delicious.com/tyru/
qmark g http://github.com/tyru
qmark h http://www.hatena.ne.jp/
qmark m http://mail.google.com/mail?hl=ja
qmark n http://tyru.yu-nagi.com/
qmark p http://www.pixiv.net/mypage.php
qmark r http://reader.livedoor.com/reader/
qmark t http://twitter.com/
qmark z bml-niconico-mp3

" }}}
"-----------------------------------------------------------------
" abbr {{{
cabbrev h@       tab help
" }}}
"-----------------------------------------------------------------
" autocmd {{{
autocmd VimperatorEnter .* pluginmanager update
" }}}
"-----------------------------------------------------------------
" プラグイン {{{

" direct_bookmark.js {{{
let direct_sbm_use_services_by_tag  = "d"
let direct_sbm_use_services_by_post = "hd"
let direct_sbm_is_use_migemo = 1
noremap a   :sbm<Space>
noremap B   :tab bentry<CR>
" }}}

" sbmcommentsviewer.js {{{
let def_sbm_format = "id,timestamp,tags,comment"
let def_sbms       = "h"
noremap b   :viewSBMComments<CR>
" }}}

" migemo_hint.js {{{
set hintmatching=custom
" }}}

" multi_requester.js {{{
noremap <C-k>       :mr<Space>
noremap <Leader>a   :mr alc<Space>
" }}}

" ime_controller.js {{{
let ex_ime_mode = "inactive"  
let textarea_ime_mode = "inactive"
" }}}

" stella.js & nicontroller.js {{{
noremap <Leader>nc      :nicomment<Space>
noremap <Leader>ni      :nicoinfo<CR>
noremap <Leader>np      :stplay<CR>
noremap <Leader>nr      :strepeat<CR>
noremap <Leader>nm      :stmute<CR>
noremap <Leader>nv      :nicommentvisible<CR>
noremap <Leader>nz      :stfullscreen<CR>
noremap <Leader>ns      :stseek!<Space>
noremap <Leader>n+      :stvolume! +10<CR>
noremap <Leader>n-      :stvolume! -10<CR>
" }}}

" appendAnchor.js {{{
let auto_append_anchor_once = "true"
" }}}

" nextlink.js {{{
let nextlink_nositeinfo_act = "f"
let nextlink_followlink = "true"
" }}}

" toggler.js {{{
js <<EOM
liberator.globalVariables.toggler = {
  go: ["set go=nbr","set go=nbrmBT"],
  sb: ["sbclose","sbar Add-ons","sbar Console","sbar Downloads","sbar Preferences"],
  go_and_sb: [
    ["set go=","sbclose"],
    ["set go=mTb","sbar Console"]
  ],
};
EOM

noremap <Leader>tg      :toggle go<CR>
noremap <Leader>ts      :toggle sb<CR>
" }}}

" feedSomeKeys_2.js {{{

autocmd LocationChange .* :fmapc

" GMail
"   add ! l gl.
autocmd LocationChange 'mail\.google\.com/mail' :fmap -depth 4 c / j k n p o u e x s r z # [ ] ! ? . gi gs gt gd ga gc gk gl <C-s> l *a *n *r *u *s *t T

" Google Groups
autocmd LocationChange 'groups\.google\.\w+\/group' :fmap -event keydown -vkey n p o

" Google Reader
"   add J K N P a.
autocmd LocationChange 'www\.google\.co\.jp/reader' :fmap -vkey a j k J K n p N P m s t v A r S N P X O gh ga gs gt gu u / ?

" RememberTheMilk
"   remove f <Esc> i d + - <Tab> <S-Tab>.
autocmd LocationChange 'www\.rememberthemilk\.com\/home\/tyru\/' :fmap -vkey a m c n p r g s h t u j y <Del> k z l 1 2 3 4 <C-S-Left> <C-S-Right> <C-S-0> <C-S-6> <C-S-7> <C-S-8> <C-S-9> <C-S-l> <Left> <Right> <Up> <Down> <PageUp> <PageDown> <Home> <End> <C-S-/>

" LDR
" add r
autocmd LocationChange 'reader\.livedoor\.com\/reader\/' :fmap j k s a p o v c <Space> <S-Space> Z z ZZ b < > r

" }}}

" copy.js {{{
js<<EOM
liberator.globalVariables.copy_templates = [{
  label: 'Tabslist',
  value: 'Current tabs copy to <UL> list',
  custom: function() {
            let result = <ul/>;
            for each ([,tab] in tabs.browsers)
                result.li += <li>
  <a href={tab.currentURI.spec}>
  {tab.contentTitle}</a>
</li>;
            return result;
          }
}];
EOM
" }}}

" }}}
"-----------------------------------------------------------------

" vim:set ft=vimperator fdm=marker:
